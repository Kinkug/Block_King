local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local LocalPlayer = Players.LocalPlayer

-- üé® RARITY COLORS
local RARITY_COLORS = {
    ["Common"] = Color3.fromRGB(200, 200, 200),
    ["Uncommon"] = Color3.fromRGB(86, 176, 62),
    ["Rare"] = Color3.fromRGB(0, 162, 255),
    ["Epic"] = Color3.fromRGB(170, 85, 255),
    ["Legendary"] = Color3.fromRGB(255, 170, 0),
    ["Omega"] = Color3.fromRGB(255, 75, 75),
}

-- üóÉÔ∏è WEAPON DATABASE
local WeaponDB = {}

local function registerItems(folder)
    for _, tool in ipairs(folder:GetChildren()) do
        local handle = tool:FindFirstChild("Handle")
        local meshId
        if handle then
            local mesh = handle:FindFirstChildOfClass("SpecialMesh")
            if mesh then
                meshId = mesh.MeshId
            elseif handle:IsA("MeshPart") then
                meshId = handle.MeshId
            end
        end

        if meshId then
            WeaponDB[meshId] = {
                Name = tool:GetAttribute("DisplayName") or tool.Name,
                Rarity = tool:GetAttribute("RarityName") or "Common",
                ImageId = tool:GetAttribute("ImageId") or "rbxassetid://7072725737",
            }
        elseif tool.Name == "Fists" then
            WeaponDB["Fists"] = {
                Name = tool:GetAttribute("DisplayName") or "Fists",
                Rarity = tool:GetAttribute("RarityName") or "Common",
                ImageId = tool:GetAttribute("ImageId") or "rbxassetid://116170302967943",
            }
        else
            WeaponDB[tool.Name] = {
                Name = tool:GetAttribute("DisplayName") or tool.Name,
                Rarity = tool:GetAttribute("RarityName") or "Common",
                ImageId = tool:GetAttribute("ImageId") or "rbxassetid://7072725737",
            }
        end
    end
end

for _, category in ipairs({"gun", "melee", "throwable", "consumable", "farming", "misc", "rod", "fish"}) do
    registerItems(ReplicatedStorage:WaitForChild("Items")[category])
end

local function getMeshId(tool)
    local handle = tool:FindFirstChild("Handle")
    if not handle then return nil end
    local mesh = handle:FindFirstChildOfClass("SpecialMesh")
    if mesh then return mesh.MeshId end
    if handle:IsA("MeshPart") then return handle.MeshId end
    return nil
end

local function getWeaponInfo(tool)
    local meshId = getMeshId(tool)
    if meshId and WeaponDB[meshId] then
        return WeaponDB[meshId]
    elseif tool.Name == "Fists" and WeaponDB["Fists"] then
        return WeaponDB["Fists"]
    elseif WeaponDB[tool.Name] then
        return WeaponDB[tool.Name]
    else
        return {
            Name = "‡∏´‡∏°‡∏±‡∏î",
            Rarity = "Common",
            ImageId = "rbxassetid://116170302967943"
        }
    end
end

local function getHighestRarity(tools)
    local order = {Common=1, Uncommon=2, Rare=3, Epic=4, Legendary=5, Omega=6}
    local max = "Common"
    for _, tool in ipairs(tools) do
        local info = getWeaponInfo(tool)
        if order[info.Rarity] and order[info.Rarity] > order[max] then
            max = info.Rarity
        end
    end
    return max
end

-- üñºÔ∏è GUI
local PlayerGui = LocalPlayer:WaitForChild("PlayerGui")
local ScreenGui = Instance.new("ScreenGui", PlayerGui)
ScreenGui.Name = "InventoryViewerGUI"

-- FRAME ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô (‡∏¢‡πà‡∏≠/‡∏Ç‡∏¢‡∏≤‡∏¢‡πÑ‡∏î‡πâ)
local listFrame = Instance.new("Frame", ScreenGui)
listFrame.Size = UDim2.new(0, 180, 0.4, 0)
listFrame.Position = UDim2.new(0, 10, 0.3, 0)
listFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
listFrame.BackgroundTransparency = 0.2
Instance.new("UICorner", listFrame).CornerRadius = UDim.new(0, 8)

local playerList = Instance.new("ScrollingFrame", listFrame)
playerList.Size = UDim2.new(1, -10, 1, -50)
playerList.Position = UDim2.new(0, 5, 0, 5)
playerList.BackgroundTransparency = 1
playerList.ScrollBarThickness = 6
playerList.AutomaticCanvasSize = Enum.AutomaticSize.Y
Instance.new("UIListLayout", playerList).Padding = UDim.new(0, 4)

local resetButton = Instance.new("TextButton", listFrame)
resetButton.Size = UDim2.new(1, -10, 0, 30)
resetButton.Position = UDim2.new(0, 5, 1, -35)
resetButton.Text = "Refresh"
resetButton.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
resetButton.TextColor3 = Color3.new(1, 1, 1)
resetButton.Font = Enum.Font.GothamBold
resetButton.TextScaled = true
Instance.new("UICorner", resetButton).CornerRadius = UDim.new(0, 6)

-- ‡∏õ‡∏∏‡πà‡∏°‡∏¢‡πà‡∏≠/‡∏Ç‡∏¢‡∏≤‡∏¢ GUI
local toggleButton = Instance.new("TextButton", listFrame)
toggleButton.Size = UDim2.new(0, 30, 0, 30)
toggleButton.Position = UDim2.new(1, -40, 0, 0)
toggleButton.Text = "<<"
toggleButton.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
toggleButton.TextColor3 = Color3.new(1, 1, 1)
toggleButton.Font = Enum.Font.GothamBold
toggleButton.TextScaled = true
Instance.new("UICorner", toggleButton).CornerRadius = UDim.new(0, 6)

local invFrame = Instance.new("Frame", ScreenGui)
invFrame.Size = UDim2.new(0, 350, 0, 300)
invFrame.Position = UDim2.new(0, 200, 0.3, 0)
invFrame.BackgroundColor3 = Color3.fromRGB(15, 15, 15)
invFrame.BackgroundTransparency = 0.2
invFrame.Visible = false
Instance.new("UICorner", invFrame).CornerRadius = UDim.new(0, 8)

local invTitle = Instance.new("TextLabel", invFrame)
invTitle.Size = UDim2.new(1, -40, 0, 30)
invTitle.Position = UDim2.new(0, 5, 0, 0)
invTitle.BackgroundTransparency = 1
invTitle.TextColor3 = Color3.new(1, 1, 1)
invTitle.Font = Enum.Font.GothamBold
invTitle.TextScaled = true
invTitle.TextXAlignment = Enum.TextXAlignment.Left

local closeButton = Instance.new("TextButton", invFrame)
closeButton.Size = UDim2.new(0, 30, 0, 30)
closeButton.Position = UDim2.new(1, -35, 0, 0)
closeButton.Text = "X"
closeButton.BackgroundColor3 = Color3.fromRGB(120, 30, 30)
closeButton.TextColor3 = Color3.new(1, 1, 1)
closeButton.Font = Enum.Font.GothamBold
closeButton.TextScaled = true
Instance.new("UICorner", closeButton).CornerRadius = UDim.new(0, 6)

local invList = Instance.new("ScrollingFrame", invFrame)
invList.Position = UDim2.new(0, 10, 0, 40)
invList.Size = UDim2.new(1, -20, 1, -50)
invList.BackgroundTransparency = 1
invList.ScrollBarThickness = 6
invList.AutomaticCanvasSize = Enum.AutomaticSize.Y
Instance.new("UIListLayout", invList).Padding = UDim.new(0, 5)

closeButton.MouseButton1Click:Connect(function()
    invFrame.Visible = false
end)

-- ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏õ‡∏∏‡πà‡∏°‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô
local playerButtons = {}
local BillboardCache = {}

-- ‡∏õ‡∏¥‡∏î‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡∏´‡∏•‡∏±‡∏Å (‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÑ‡∏°‡πà‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï Billboard, ‡πÑ‡∏°‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏õ‡∏∏‡πà‡∏°‡πÉ‡∏´‡∏°‡πà)
local scriptEnabled = false

-- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á Billboard ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô (‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡∏¥‡∏î‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå)
local function createBillboardForPlayer(player)
    if not scriptEnabled then return end
    if player == LocalPlayer then return end
    local char = player.Character
    if not char then return end
    local hrp = char:FindFirstChild("HumanoidRootPart")
    if not hrp then return end

    if BillboardCache[player] then
        BillboardCache[player]:Destroy()
    end

    local billboard = Instance.new("BillboardGui")
    billboard.Adornee = hrp
    billboard.Size = UDim2.new(0, 150, 0, 30)
    billboard.StudsOffset = Vector3.new(0, 3, 0)
    billboard.AlwaysOnTop = true
    billboard.Parent = char

    billboard:ClearAllChildren()

    local tools = {}
    for _, container in ipairs({"Backpack", "StarterGear", "StarterPack"}) do
        local obj = player:FindFirstChild(container)
        if obj then
            for _, tool in ipairs(obj:GetChildren()) do
                if tool:IsA("Tool") then table.insert(tools, tool) end
            end
        end
    end
    if player.Character then
        for _, tool in ipairs(player.Character:GetChildren()) do
            if tool:IsA("Tool") then table.insert(tools, tool) end
        end
    end

    local padding = 8
    local imageSize = 28
    local layout = Instance.new("UIListLayout", billboard)
    layout.FillDirection = Enum.FillDirection.Horizontal
    layout.SortOrder = Enum.SortOrder.LayoutOrder
    layout.Padding = UDim.new(0, padding)
    layout.HorizontalAlignment = Enum.HorizontalAlignment.Center

    for i, tool in ipairs(tools) do
        local info = getWeaponInfo(tool)
        
        -- ‡∏Ç‡πâ‡∏≤‡∏°‡∏ñ‡πâ‡∏≤ Rarity = "Common"
        if info.Rarity ~= "Common" then
            local img = Instance.new("ImageLabel", billboard)
            img.Size = UDim2.new(0, imageSize, 0, imageSize)
            img.BackgroundTransparency = 1
            img.Image = info.ImageId
            img.LayoutOrder = i

            local uicorner = Instance.new("UICorner", img)
            uicorner.CornerRadius = UDim.new(0, 15)

            local border = Instance.new("Frame", img)
            border.Size = UDim2.new(1, 6, 1, 6)
            border.Position = UDim2.new(0, -3, 0, -3)
            border.ZIndex = img.ZIndex - 1
            border.BackgroundColor3 = RARITY_COLORS[info.Rarity] or Color3.new(1, 1, 1)
            border.AnchorPoint = Vector2.new(0, 0)
            border.ClipsDescendants = true
            local borderCorner = Instance.new("UICorner", border)
            borderCorner.CornerRadius = UDim.new(0, 8.5)
        end
    end

    BillboardCache[player] = billboard
end

local function showInventory(player)
    invTitle.Text = "Inventory: " .. player.Name
    invFrame.Visible = true

    for _, c in ipairs(invList:GetChildren()) do
        if not c:IsA("UIListLayout") then
            c:Destroy()
        end
    end

    local tools = {}
    for _, container in ipairs({"Backpack", "StarterGear", "StarterPack"}) do
        local obj = player:FindFirstChild(container)
        if obj then
            for _, tool in ipairs(obj:GetChildren()) do
                if tool:IsA("Tool") then table.insert(tools, tool) end
            end
        end
    end
    if player.Character then
        for _, tool in ipairs(player.Character:GetChildren()) do
            if tool:IsA("Tool") then table.insert(tools, tool) end
        end
    end

    for _, tool in ipairs(tools) do
        local info = getWeaponInfo(tool)

        local frame = Instance.new("Frame", invList)
        frame.Size = UDim2.new(1, -10, 0, 50)
        frame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
        frame.BorderSizePixel = 0
        Instance.new("UICorner", frame).CornerRadius = UDim.new(0, 6)

        local img = Instance.new("ImageLabel", frame)
        img.Size = UDim2.new(0, 40, 0, 40)
        img.Position = UDim2.new(0, 5, 0, 5)
        img.Image = info.ImageId
        img.BackgroundTransparency = 1
        Instance.new("UICorner", img).CornerRadius = UDim.new(0, 6)

        -- Tooltip ‡πÅ‡∏™‡∏î‡∏á rarity ‡πÄ‡∏ß‡∏•‡∏≤‡∏ä‡∏µ‡πâ
        local tooltip = Instance.new("TextLabel")
        tooltip.Size = UDim2.new(0, 100, 0, 25)
        tooltip.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
        tooltip.TextColor3 = RARITY_COLORS[info.Rarity] or Color3.new(1,1,1)
        tooltip.Text = info.Rarity
        tooltip.Font = Enum.Font.GothamBold
        tooltip.TextSize = 14
        tooltip.TextWrapped = true
        tooltip.Visible = false
        tooltip.Parent = frame
        tooltip.AnchorPoint = Vector2.new(0.5, 1)

        img.MouseEnter:Connect(function()
            tooltip.Visible = true
            local absPos = img.AbsolutePosition
            tooltip.Position = UDim2.new(0, absPos.X + img.AbsoluteSize.X/2, 0, absPos.Y - 30)
            tooltip.ZIndex = 10
        end)
        img.MouseLeave:Connect(function()
            tooltip.Visible = false
        end)

        local name = Instance.new("TextLabel", frame)
        name.Size = UDim2.new(1, -50, 1, 0)
        name.Position = UDim2.new(0, 50, 0, 0)
        name.TextColor3 = RARITY_COLORS[info.Rarity] or Color3.new(1,1,1)
        name.Text = info.Name
        name.Font = Enum.Font.GothamBold
        name.TextSize = 18
        name.TextXAlignment = Enum.TextXAlignment.Left
        name.BackgroundTransparency = 1
    end
end

local function createPlayerButton(player)
    if not scriptEnabled then return end

    local tools = {}
    for _, container in ipairs({"Backpack", "StarterGear", "StarterPack"}) do
        local obj = player:FindFirstChild(container)
        if obj then
            for _, tool in ipairs(obj:GetChildren()) do
                if tool:IsA("Tool") then table.insert(tools, tool) end
            end
        end
    end
    if player.Character then
        for _, tool in ipairs(player.Character:GetChildren()) do
            if tool:IsA("Tool") then table.insert(tools, tool) end
        end
    end

    local button = Instance.new("TextButton", playerList)
    button.Size = UDim2.new(1, -10, 0, 28)
    button.Text = player.Name
    button.TextScaled = true
    button.Font = Enum.Font.GothamBold
    button.BackgroundColor3 = RARITY_COLORS[getHighestRarity(tools)] or Color3.fromRGB(40, 40, 40)
    button.TextColor3 = Color3.new(1, 1, 1)
    Instance.new("UICorner", button).CornerRadius = UDim.new(0, 6)

    button.MouseButton1Click:Connect(function()
        showInventory(player)
    end)

    createBillboardForPlayer(player)

    playerButtons[player] = button
end

local function refreshPlayerList()
    if not scriptEnabled then return end

    for _, child in ipairs(playerList:GetChildren()) do
        if child:IsA("TextButton") and child ~= resetButton and child ~= toggleButton then child:Destroy() end
    end
    playerButtons = {}
    for _, p in ipairs(Players:GetPlayers()) do
        if p ~= LocalPlayer then
            createPlayerButton(p)
        end
    end
end

resetButton.MouseButton1Click:Connect(refreshPlayerList)

Players.PlayerAdded:Connect(function(p)
    if p ~= LocalPlayer and scriptEnabled then
        createPlayerButton(p)
    end
end)

Players.PlayerRemoving:Connect(function(p)
    if playerButtons[p] then
        playerButtons[p]:Destroy()
        playerButtons[p] = nil
    end
    if BillboardCache[p] then
        BillboardCache[p]:Destroy()
        BillboardCache[p] = nil
    end
end)

toggleButton.MouseButton1Click:Connect(function()
    scriptEnabled = not scriptEnabled
    if scriptEnabled then
        toggleButton.Text = ">>"
        listFrame.Size = UDim2.new(0, 180, 0.4, 0)
        listFrame.Position = UDim2.new(0, 10, 0.3, 0)
        resetButton.Visible = true
        playerList.Visible = true
        refreshPlayerList()
    else
        toggleButton.Text = "<<"
        listFrame.Size = UDim2.new(0, 40, 0.4, 0)
        listFrame.Position = UDim2.new(0, 10, 0.3, 0)
        resetButton.Visible = false
        playerList.Visible = false
        invFrame.Visible = false
        for p, btn in pairs(playerButtons) do
            if btn then btn:Destroy() end
        end
        playerButtons = {}
    end
end)

-- ‡∏™‡∏£‡πâ‡∏≤‡∏á Frame ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏∏‡∏°‡∏Ç‡∏ß‡∏≤‡∏•‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠
local alertFrame = Instance.new("Frame", ScreenGui)
alertFrame.AnchorPoint = Vector2.new(1, 1)
alertFrame.Position = UDim2.new(1, -10, 1, -10)
alertFrame.Size = UDim2.new(0, 300, 0, 0) -- ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏î‡πâ‡∏ß‡∏¢‡∏™‡∏π‡∏á 0
alertFrame.BackgroundTransparency = 1
alertFrame.ClipsDescendants = true

local UIListLayout = Instance.new("UIListLayout", alertFrame)
UIListLayout.SortOrder = Enum.SortOrder.LayoutOrder
UIListLayout.Padding = UDim.new(0, 5)

-- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á alert ‡πÄ‡∏î‡πâ‡∏á
local function showAlert(playerName, rarity)
    local color = RARITY_COLORS[rarity] or Color3.new(1,1,1)

    local alert = Instance.new("Frame", alertFrame)
    alert.Size = UDim2.new(1, 0, 0, 40)
    alert.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    alert.BorderSizePixel = 0
    alert.ClipsDescendants = true
    alert.LayoutOrder = tick()
    alert.AnchorPoint = Vector2.new(0.5, 0.5)
    alert.Position = UDim2.new(0.5, 0, 0.5, 0)
    alert.BackgroundTransparency = 1  -- ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÇ‡∏õ‡∏£‡πà‡∏á‡πÉ‡∏™

    local uicorner = Instance.new("UICorner", alert)
    uicorner.CornerRadius = UDim.new(0, 10)

    local bgGradient = Instance.new("UIGradient", alert)
    bgGradient.Color = ColorSequence.new{
        ColorSequenceKeypoint.new(0, Color3.fromRGB(255, 255, 255)),
        ColorSequenceKeypoint.new(0.5, Color3.fromRGB(180, 220, 255)),
        ColorSequenceKeypoint.new(1, Color3.fromRGB(255, 255, 255)),
    }
    bgGradient.Rotation = 90

    local textLabel = Instance.new("TextLabel", alert)
    textLabel.Size = UDim2.new(1, -10, 1, 0)
    textLabel.Position = UDim2.new(0, 5, 0, 0)
    textLabel.BackgroundTransparency = 1
    textLabel.Font = Enum.Font.GothamBold
    textLabel.TextSize = 15
    textLabel.TextColor3 = color
    textLabel.TextXAlignment = Enum.TextXAlignment.Left
    textLabel.Text = ("‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô : %s   ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏£‡∏£‡πå : %s"):format(playerName, rarity)

    -- ‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î alertFrame ‡∏™‡∏π‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö alert ‡πÉ‡∏´‡∏°‡πà
    alertFrame.Size = UDim2.new(0, 300, 0, alertFrame.Size.Y.Offset + 45)

    local tweenService = game:GetService("TweenService")

    -- ‡∏™‡πÄ‡∏Å‡∏•‡πÄ‡∏•‡πá‡∏Å ‡πÜ ‡∏Å‡πà‡∏≠‡∏ô (‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏•‡∏π‡∏Å‡∏ö‡∏≠‡∏•‡∏Å‡∏•‡∏¥‡πâ‡∏á‡∏°‡∏≤)
    alert.Size = UDim2.new(0, 0, 0, 0)
    alert.Position = UDim2.new(0.5, 0, 0.5, 0)

    local tweenInSize = tweenService:Create(alert, TweenInfo.new(0.4, Enum.EasingStyle.Sine, Enum.EasingDirection.Out), {Size = UDim2.new(1, 0, 0, 40), BackgroundTransparency = 0})
    local tweenBounce = tweenService:Create(alert, TweenInfo.new(0.2, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {Size = UDim2.new(1.05, 0, 0, 44)})
    local tweenBounceBack = tweenService:Create(alert, TweenInfo.new(0.2, Enum.EasingStyle.Back, Enum.EasingDirection.In), {Size = UDim2.new(1, 0, 0, 40)})

    tweenInSize:Play()
    tweenInSize.Completed:Connect(function()
        tweenBounce:Play()
        tweenBounce.Completed:Connect(function()
            tweenBounceBack:Play()
            tweenBounceBack.Completed:Connect(function()
                wait(5) -- ‡πÅ‡∏™‡∏î‡∏á alert 3 ‡∏ß‡∏¥

                local tweenOut = tweenService:Create(alert, TweenInfo.new(0.3, Enum.EasingStyle.Sine, Enum.EasingDirection.In), {BackgroundTransparency = 1, Size = UDim2.new(0, 0, 0, 0)})
                tweenOut:Play()
                tweenOut.Completed:Connect(function()
                    alert:Destroy()
                    alertFrame.Size = UDim2.new(0, 300, 0, alertFrame.Size.Y.Offset - 45)
                end)
            end)
        end)
    end)
end

-- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ç‡∏≠‡∏á Rare ‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ‡πÅ‡∏•‡∏∞‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
local alertedPlayers = {}

local function checkAndAlert(player)
    local tools = {}
    for _, container in ipairs({"Backpack", "StarterGear", "StarterPack"}) do
        local obj = player:FindFirstChild(container)
        if obj then
            for _, tool in ipairs(obj:GetChildren()) do
                if tool:IsA("Tool") then
                    table.insert(tools, tool)
                end
            end
        end
    end
    if player.Character then
        for _, tool in ipairs(player.Character:GetChildren()) do
            if tool:IsA("Tool") then
                table.insert(tools, tool)
            end
        end
    end

    local order = {Common=1, Uncommon=2, Rare=3, Epic=4, Legendary=5, Omega=6}
    local maxRarity = "Common"
    for _, tool in ipairs(tools) do
        local info = getWeaponInfo(tool)
        if order[info.Rarity] and order[info.Rarity] > order[maxRarity] then
            maxRarity = info.Rarity
        end
    end

    if order[maxRarity] and order[maxRarity] >= order["Uncommon"] then
        if not alertedPlayers[player] or alertedPlayers[player] ~= maxRarity then
            alertedPlayers[player] = maxRarity
            showAlert(player.Name, maxRarity)
        end
    else
        alertedPlayers[player] = nil
    end
end

-- ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ó‡∏∏‡∏Å‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ‡∏Ñ‡∏£‡∏∂‡πà‡∏á
spawn(function()
    while true do
        for _, p in ipairs(Players:GetPlayers()) do
            if p ~= LocalPlayer then
                checkAndAlert(p)
            end
        end
        wait(0.5)
    end
end)

-- ‡∏õ‡∏¥‡∏î‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡∏ï‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô (GUI ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏ï‡πà‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡πÑ‡∏°‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô)
scriptEnabled = true
toggleButton.Text = "<<"
resetButton.Visible = true
playerList.Visible = true
